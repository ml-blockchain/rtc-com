{"code":"!function(n){var e={};function t(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(n,\"__esModule\",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&\"object\"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:n}),2&e&&\"string\"!=typeof n)for(var o in n)t.d(r,o,function(e){return n[e]}.bind(null,o));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,\"a\",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p=\"\",t(t.s=0)}([function(n,e,t){n.exports=t(1)},function(n,e,t){\"use strict\";function r(n,e,t,r,o,i,c){try{var a=n[i](c),u=a.value}catch(n){return void t(n)}a.done?e(u):Promise.resolve(u).then(r,o)}function o(n){return function(){var e=this,t=arguments;return new Promise(function(o,i){var c=n.apply(e,t);function a(n){r(c,o,i,a,u,\"next\",n)}function u(n){r(c,o,i,a,u,\"throw\",n)}a(void 0)})}}function i(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}t.r(e);var c=function(){function n(e){!function(n,e){if(!(n instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,n),this.connected=!1,this.socket=io(\"http://localhost:3000\",{}),this.name=e,this.partner=null,this.connection=new RTCPeerConnection,this.channel=this.connection.createDataChannel(\"chat\")}return function(n,e,t){e&&i(n.prototype,e),t&&i(n,t)}(n,[{key:\"output\",value:function(n,e){console.log(this.name+\" > \"+n?n:\"\",e||\"\")}},{key:\"init\",value:function(){var n=o(regeneratorRuntime.mark(function n(){var e=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:this.socket.emit(\"addClient\",this.name),this.socket.on(\"offer\",this.getOffer.bind(this)),this.socket.on(\"answer\",this.getAnswer.bind(this)),this.socket.on(\"candidate\",this.getCandidate.bind(this)),this.connection.addEventListener(\"icecandidate\",function(){var n=o(regeneratorRuntime.mark(function n(t){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.candidate&&e.socket.emit(\"candidate\",{partner:e.partner,candidate:t.candidate});case 1:case\"end\":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()),this.channel.onopen=function(n){console.log(\"open!\"),\"open\"===e.channel.readyState&&(console.log(\"sending\"),e.channel.send(\"Hello\"))},this.connection.ondatachannel=function(n){this.channel=n.channel,this.channel.onmessage=function(n){alert(n.data)}}.bind(this);case 7:case\"end\":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}()},{key:\"offer\",value:function(n){var e,t=this;this.partner=n,this.connection.createOffer().then(function(n){return e=n}).then(function(){return t.connection.setLocalDescription(e)}).then(function(){return t.socket.emit(\"offer\",{partner:n,offer:e})})}},{key:\"getOffer\",value:function(n){var e,t=this,r=n.offer,o=n.senderName;this.connection.setRemoteDescription(r).then(function(){return t.connection.createAnswer()}).then(function(n){return e=n}).then(function(){return t.connection.setLocalDescription(e)}).then(function(){return t.socket.emit(\"answer\",{answer:e,senderName:o})})}},{key:\"getAnswer\",value:function(){var n=o(regeneratorRuntime.mark(function n(e){var t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.answer,n.next=3,this.connection.setRemoteDescription(t);case 3:case\"end\":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()},{key:\"getCandidate\",value:function(){var n=o(regeneratorRuntime.mark(function n(e){var t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.candidate,n.next=3,this.connection.addIceCandidate(t);case 3:case\"end\":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()}]),n}();t.d(e,\"Client\",function(){return c})}]);","extractedComments":[]}